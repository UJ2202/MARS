/srv/projects/mas/mars/denario/cmbagent/test_integration_flow.py:422: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  print(f"Start Time: {datetime.utcnow().isoformat()}")
/srv/projects/mas/mars/denario/cmbagent/test_integration_flow.py:97: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "started_at": datetime.utcnow().isoformat(),
/srv/projects/mas/mars/denario/cmbagent/test_integration_flow.py:215: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "timestamp": datetime.utcnow().isoformat()
/srv/projects/mas/mars/denario/cmbagent/test_integration_flow.py:245: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "timestamp": datetime.utcnow().isoformat()
/srv/projects/mas/mars/denario/cmbagent/test_integration_flow.py:349: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  results["completed_at"] = datetime.utcnow().isoformat()

[95m[1m================================================================================[0m
[95m[1m  COMPREHENSIVE INTEGRATION TEST - PARALLEL SESSIONS[0m
[95m[1m================================================================================[0m

Start Time: 2026-01-15T09:08:49.524278
Database: /home/ujjwal/.cmbagent/cmbagent.db


[94m[1m================================================================================[0m
[94m[1m  LAUNCHING PARALLEL SESSIONS[0m
[94m[1m================================================================================[0m

<IPython.core.display.Image object>
<IPython.core.display.Markdown object>

[96m[1m================================================================================[0m
[96m[1m  SESSION: research_session_alpha[0m
[96m[1m================================================================================[0m

  [96m‚ñ∂[0m Initializing session...

[96m[1m================================================================================[0m
[96m[1m  SESSION: research_session_beta[0m
[96m[1m================================================================================[0m

  [96m‚ñ∂[0m Initializing session...
    [94m‚Ñπ[0m Session created: 3012eb4d-469e-491e-a023-6799df0f0926
  [92m‚úì[0m Session initialized
  [96m‚ñ∂[0m Creating workflow run...
    [94m‚Ñπ[0m Session created: d5aa1810-881c-4463-a158-78a5ccedbf61
  [92m‚úì[0m Session initialized
  [96m‚ñ∂[0m Creating workflow run...
    [94m‚Ñπ[0m Workflow run created: 6146df6f-3b26-475b-90f6-ff2b90f7a6fb
  [92m‚úì[0m Workflow run created
  [96m‚ñ∂[0m Building execution DAG...
    [94m‚Ñπ[0m Workflow run created: 5b29dbce-13fc-4031-bcec-379f9a35c8c3
  [92m‚úì[0m Workflow run created
  [96m‚ñ∂[0m Building execution DAG...
    [94m‚Ñπ[0m DAG created with 7 nodes
    [94m‚Ñπ[0m Execution levels: 6 (parallel execution enabled)
  [92m‚úì[0m DAG built successfully
  [96m‚ñ∂[0m Starting workflow execution...
    [94m‚Ñπ[0m DAG created with 7 nodes
    [94m‚Ñπ[0m Execution levels: 6 (parallel execution enabled)
  [92m‚úì[0m DAG built successfully
  [96m‚ñ∂[0m Starting workflow execution...
    [94m‚Ñπ[0m State: DRAFT ‚Üí PLANNING
    [94m‚Ñπ[0m State: DRAFT ‚Üí PLANNING
    [94m‚Ñπ[0m State: PLANNING ‚Üí EXECUTING
  [92m‚úì[0m Workflow execution started
  [96m‚ñ∂[0m Executing parallel data gathering steps...
    [94m‚Ñπ[0m State: PLANNING ‚Üí EXECUTING
  [92m‚úì[0m Workflow execution started
  [96m‚ñ∂[0m Executing parallel data gathering steps...
    [94m‚Ñπ[0m Parallel steps completed simultaneously
  [92m‚úì[0m Parallel data gathering completed
  [96m‚ñ∂[0m Executing data analysis step...
    [94m‚Ñπ[0m Parallel steps completed simultaneously
  [92m‚úì[0m Parallel data gathering completed
  [96m‚ñ∂[0m Executing data analysis step...
  [93m‚Üª[0m Simulating error in analysis (retrying)
Warning: Could not load retry attempt: 1 validation error for RetryAttempt
started_at
  Field required [type=missing, input_value={'attempt_number': 1, 'er...-01-15T09:08:55.346162'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.12/v/missing
  [93m‚Üª[0m Simulating error in analysis (retrying)
Warning: Could not load retry attempt: 1 validation error for RetryAttempt
started_at
  Field required [type=missing, input_value={'attempt_number': 1, 'er...-01-15T09:08:55.356160'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.12/v/missing
Warning: Could not query similar errors: 'NoneType' object has no attribute 'get'
    [94m‚Ñπ[0m Retry initiated: Attempt 2/3
    [94m‚Ñπ[0m Error category: file_not_found
    [94m‚Ñπ[0m Suggestions: 4
Warning: Could not query similar errors: 'NoneType' object has no attribute 'get'
    [94m‚Ñπ[0m Retry initiated: Attempt 2/3
    [94m‚Ñπ[0m Error category: file_not_found
    [94m‚Ñπ[0m Suggestions: 4
  [92m‚úì[0m Analysis completed after retry
  [96m‚ñ∂[0m Testing pause/resume functionality...
  [92m‚úì[0m Analysis completed after retry
  [96m‚ñ∂[0m Testing pause/resume functionality...
    [94m‚Ñπ[0m Workflow paused
  [93m‚è∏[0m Workflow paused (paused)
    [94m‚Ñπ[0m Workflow paused
  [93m‚è∏[0m Workflow paused (paused)
    [94m‚Ñπ[0m Workflow resumed
  [92m‚úì[0m Workflow resumed successfully
  [96m‚ñ∂[0m Requesting approval for report generation...
    [94m‚Ñπ[0m Workflow resumed
  [92m‚úì[0m Workflow resumed successfully
  [96m‚ñ∂[0m Requesting approval for report generation...
    [94m‚Ñπ[0m Approval requested: dc5ae0bf-5eed-45e8-9182-05fab6e6546c
    [94m‚Ñπ[0m Approval requested: 5a6c7143-6133-4c5c-8d35-a5fe4bdbc986
    [94m‚Ñπ[0m Approval granted by user
  [92m‚úì[0m Approval checkpoint passed
    [94m‚Ñπ[0m Approval granted by user
  [92m‚úì[0m Approval checkpoint passed
  [96m‚ñ∂[0m Creating experimental branch...
  [96m‚ñ∂[0m Creating experimental branch...
    [94m‚Ñπ[0m Branch created: 2fc92175-3974-4694-9ad1-ea39cfc64f53
  [92m‚úì[0m Experimental branch created
  [96m‚ñ∂[0m Testing play-from-node executor...
    [94m‚Ñπ[0m Branch created: 8e68a290-ee63-486d-9c3c-d3ac9d4e7748
  [92m‚úì[0m Experimental branch created
  [96m‚ñ∂[0m Testing play-from-node executor...
    [94m‚Ñπ[0m Resumable nodes found: 7
  [92m‚úì[0m Play-from-node verified
  [96m‚ñ∂[0m Completing workflow...
    [94m‚Ñπ[0m State: EXECUTING ‚Üí COMPLETED
  [92m‚úì[0m Workflow completed successfully

  [92m[1m‚úì SESSION research_session_alpha COMPLETED SUCCESSFULLY[0m
    [94m‚Ñπ[0m Total steps: 11
    [94m‚Ñπ[0m Retries: 1
    [94m‚Ñπ[0m Approvals: 1
    [94m‚Ñπ[0m Branches: 1
    [94m‚Ñπ[0m Resumable nodes found: 7
  [92m‚úì[0m Play-from-node verified
  [96m‚ñ∂[0m Completing workflow...
    [94m‚Ñπ[0m State: EXECUTING ‚Üí COMPLETED
  [92m‚úì[0m Workflow completed successfully

  [92m[1m‚úì SESSION research_session_beta COMPLETED SUCCESSFULLY[0m
    [94m‚Ñπ[0m Total steps: 11
    [94m‚Ñπ[0m Retries: 1
    [94m‚Ñπ[0m Approvals: 1
    [94m‚Ñπ[0m Branches: 1

[93m[1m================================================================================[0m
[93m[1m  VERIFYING SESSION SEGREGATION[0m
[93m[1m================================================================================[0m

  [96m‚ñ∂[0m Checking session IDs...
    [94m‚Ñπ[0m Session 1: d5aa1810-881c-4463-a158-78a5ccedbf61
    [94m‚Ñπ[0m Session 2: 3012eb4d-469e-491e-a023-6799df0f0926
  [92m‚úì[0m Session IDs are different
  [96m‚ñ∂[0m Checking workflow isolation...
    [94m‚Ñπ[0m Session 1 runs: 2
    [94m‚Ñπ[0m Session 2 runs: 2
    [94m‚Ñπ[0m No workflow cross-contamination detected
  [92m‚úì[0m Workflows are properly isolated

  [92m[1m‚úì SESSION SEGREGATION VERIFIED[0m

[95m[1m================================================================================[0m
[95m[1m  FINAL SUMMARY[0m
[95m[1m================================================================================[0m

Session 1 (Alpha): [92m‚úì SUCCESS[0m
Session 2 (Beta):  [92m‚úì SUCCESS[0m
Session Segregation: [92m‚úì VERIFIED[0m

[1mFeature Verification:[0m
  [92m‚úì[0m Database & Session Management
  [92m‚úì[0m State Machine & Transitions
  [92m‚úì[0m DAG Building & Topological Sort
  [92m‚úì[0m Parallel Execution
  [92m‚úì[0m Sequential Dependencies
  [92m‚úì[0m Context-Aware Retry
  [92m‚úì[0m Pause/Resume
  [92m‚úì[0m HITL Approval
  [92m‚úì[0m Branching
  [92m‚úì[0m Play-from-Node
  [92m‚úì[0m Session Isolation

[1mSaving detailed results...[0m
  Results saved to: integration_test_results.json

================================================================================
[92m[1m‚úì ALL INTEGRATION TESTS PASSED![0m
[92m  CMBAgent stages 1-9 are fully functional and flawless![0m
